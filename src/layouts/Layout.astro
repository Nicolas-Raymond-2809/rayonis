---
import '@fontsource/space-grotesk';
import '@fontsource/jetbrains-mono';
import ContactModal from '../components/ContactModal.astro';

interface Props {
	title: string;
}

const { title } = Astro.props;
---

<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="description" content="Rayonis - Neo-Brutalist Blog" />
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" type="image/png" href="/favicon.png" />
		<meta name="generator" content={Astro.generator} />
		<title>{title}</title>
	</head>
	<body class="bg-rayonis-bg text-rayonis-text font-sans antialiased min-h-screen">
		<slot />
	</body>
</html>

<style is:global>
	:root {
		--accent-pro: #06B6D4;
		--accent-academy: #FFD100;
	}
	html {
		font-family: 'Space Grotesk', system-ui, sans-serif;
	}
	code {
		font-family: 'JetBrains Mono', monospace;
	}
</style>

<script>
  // Open modal
  document.addEventListener('DOMContentLoaded', () => {
    const modal = document.getElementById('contact-modal');
    const closeButton = document.getElementById('close-modal');
    // Use event delegation or re-query triggers if they are dynamically added, 
    // but for static Astro, re-querying inside the listener or using a broad selector is fine.
    // However, if we put this script in Layout, it runs once.
    
    function setupTriggers() {
        const triggers = document.querySelectorAll('[data-contact-modal]');
        triggers.forEach(trigger => {
            trigger.addEventListener('click', (e) => {
                e.preventDefault();
                modal?.classList.remove('hidden');
                setTimeout(() => {
                    modal?.classList.add('show');
                }, 10);
                document.body.style.overflow = 'hidden';
            });
        });
    }

    setupTriggers();

    // Close modal on close button
    closeButton?.addEventListener('click', () => {
      closeModal();
    });

    // Close modal on overlay click
    modal?.addEventListener('click', (e) => {
      if (e.target === modal) {
        closeModal();
      }
    });

    // Close modal on escape key
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && modal?.classList.contains('show')) {
        closeModal();
      }
    });

    function closeModal() {
      modal?.classList.remove('show');
      setTimeout(() => {
        modal?.classList.add('hidden');
        document.body.style.overflow = '';
      }, 300);
    }
  });
</script>

<ContactModal />

