---
interface Props {
  title: string;
  description: string;
  date: Date;
  tags: string[];
  type: 'pro' | 'academy' | 'blog';
  slug: string;
  image?: string;
}

const { title, description, date, tags, type, slug, image } = Astro.props;

const isPro = type === 'pro';
const isBlog = type === 'blog';

let accentColor;
if (isPro) {
  accentColor = 'bg-rayonis-pro';
} else if (isBlog) {
  accentColor = 'bg-purple-400'; // Vibe Coding / Tech color
} else {
  accentColor = 'bg-rayonis-academy';
}

const borderRadius = isPro ? 'rounded-none' : 'rounded-2xl';

let label;
if (isPro) {
  label = 'Entreprise';
} else if (isBlog) {
  label = 'Vibe Coding';
} else {
  label = 'Jeune';
}
---

<a href={`/rayonis/${type}/${slug}`} class={`block group relative h-full transition-transform active:translate-x-[2px] active:translate-y-[2px]`}>
  <article class={`
    h-full
    border-2 border-rayonis-text
    bg-white
    ${borderRadius}
    overflow-hidden
    flex flex-col
    p-6
    hover:shadow-neo transition-shadow
  `}>
    <!-- Category Label & Thumbnail -->
    <div class="mb-4 flex justify-between items-start">
      <div class="flex flex-col">
        <span class={`inline-block px-2 py-1 text-xs font-mono font-bold uppercase border border-rayonis-text ${accentColor} text-black mb-8`}>
          {label}
        </span>
        <div class="mb-2">
          <time datetime={date.toISOString()} class="font-mono text-sm text-gray-600">
            {date.toLocaleDateString('fr-FR', { year: 'numeric', month: 'long', day: 'numeric' })}
          </time>
        </div>
      </div>
      
      {image && (
          <div class="w-20 h-14 border-2 border-rayonis-text shadow-sm overflow-hidden bg-gray-100">
             <img src={image} alt="" class="w-full h-full object-cover" />
          </div>
      )}
    </div>

    <h2 class="text-xl font-bold mb-3 leading-tight group-hover:text-purple-700 transition-colors">
      {title}
    </h2>

      <p class="text-gray-700 mb-6 flex-grow font-sans line-clamp-3">
        {description}
      </p>

      <div class="flex flex-wrap gap-2 mt-auto pt-4 border-t-2 border-dashed border-gray-200">
        {tags.map((tag) => (
          <span class={`px-2 py-1 text-xs font-mono border border-rayonis-text ${isPro ? 'bg-gray-50' : 'bg-yellow-50'} ${isPro ? 'rounded-none' : 'rounded-md'}`}>
            #{tag}
          </span>
        ))}
      </div>
  </article>
</a>
